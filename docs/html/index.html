<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DelegateMQ: DelegateMQ</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DelegateMQ
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">DelegateMQ </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> <img src="https://img.shields.io/github/license/BehaviorTree/BehaviorTree.CPP?color=blue" alt="License MIT" class="inline"/> <a href="https://github.com/endurodave/DelegateMQ/actions/workflows/cmake_ubuntu.yml"><img src="https://github.com/endurodave/DelegateMQ/actions/workflows/cmake_ubuntu.yml/badge.svg" alt="conan Ubuntu" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/endurodave/DelegateMQ/actions/workflows/cmake_clang.yml"><img src="https://github.com/endurodave/DelegateMQ/actions/workflows/cmake_clang.yml/badge.svg" alt="conan Ubuntu" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/endurodave/DelegateMQ/actions/workflows/cmake_windows.yml"><img src="https://github.com/endurodave/DelegateMQ/actions/workflows/cmake_windows.yml/badge.svg" alt="conan Windows" style="pointer-events: none;" class="inline"/></a> <a href="https://app.codecov.io/gh/endurodave/DelegateMQ"><img src="https://codecov.io/gh/endurodave/DelegateMQ/branch/master/graph/badge.svg" alt="Codecov" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md0"></a>
Delegates in C++</h1>
<p>The DelegateMQ C++ library enables function invocations on any callable, either synchronously, asynchronously, or on a remote endpoint. This messaging middleware library unifies function calls across threads, processes, or processors through a simple delegate interface. It provides well-defined abstract interfaces and numerous concrete examples, making it easy to port to any platform. As a header-only template library, DelegateMQ is thread-safe, unit-tested, and easy to use.</p>
<div class="fragment"><div class="line"><span class="comment">// Create an async delegate targeting lambda on thread1</span></div>
<div class="line"><span class="keyword">auto</span> lambda = [](<span class="keywordtype">int</span> i) { std::cout &lt;&lt; i; };</div>
<div class="line"><span class="keyword">auto</span> lambdaDelegate = <a class="code hl_function" href="namespacedmq.html#a65e308cc5f3e37d2f7f89c72b9744ae2">dmq::MakeDelegate</a>(std::function(lambda), thread1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create an async delegate targeting Class::Func() on thread2</span></div>
<div class="line">Class myClass;</div>
<div class="line"><span class="keyword">auto</span> memberDelegate = <a class="code hl_function" href="namespacedmq.html#a65e308cc5f3e37d2f7f89c72b9744ae2">dmq::MakeDelegate</a>(&amp;myClass, &amp;Class::Func, thread2);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a thread-safe delegate container</span></div>
<div class="line"><a class="code hl_struct" href="structdmq_1_1_multicast_delegate_safe.html">dmq::MulticastDelegateSafe</a>&lt;void(<span class="keywordtype">int</span>)&gt; delegates;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Insert delegates into the container </span></div>
<div class="line">delegates += lambdaDelegate;</div>
<div class="line">delegates += memberDelegate;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Invoke all callable targets asynchronously </span></div>
<div class="line">delegates(123);</div>
<div class="ttc" id="anamespacedmq_html_a65e308cc5f3e37d2f7f89c72b9744ae2"><div class="ttname"><a href="namespacedmq.html#a65e308cc5f3e37d2f7f89c72b9744ae2">dmq::MakeDelegate</a></div><div class="ttdeci">auto MakeDelegate(RetType(*func)(Args... args))</div><div class="ttdoc">Creates a delegate that binds to a free function.</div><div class="ttdef"><b>Definition</b> Delegate.h:670</div></div>
<div class="ttc" id="astructdmq_1_1_multicast_delegate_safe_html"><div class="ttname"><a href="structdmq_1_1_multicast_delegate_safe.html">dmq::MulticastDelegateSafe</a></div><div class="ttdef"><b>Definition</b> MulticastDelegateSafe.h:14</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<p>In C++, a delegate function object encapsulates a callable entity, such as a function, method, or lambda, so it can be invoked later. A delegate is a type-safe wrapper around a callable function that allows it to be passed around, stored, or invoked at a later time, typically within different contexts or on different threads. Delegates are particularly useful for event-driven programming, callbacks, asynchronous APIs, or when you need to pass functions as arguments.</p>
<p>Synchronous and asynchronous delegates are available. Asynchronous variants handle both non-blocking and blocking modes with a timeout. The library supports all types of target functions, including free functions, class member functions, static class functions, lambdas, and <code>std::function</code>. It is capable of handling any function signature, regardless of the number of arguments or return value. All argument types are supported, including by value, pointers, pointers to pointers, and references. The delegate library takes care of the intricate details of function invocation across thread boundaries. Concrete porting examples below with easy porting to others.</p>
<ul>
<li><b>Operating System:</b> Windows, Linux, <a href="https://github.com/FreeRTOS/FreeRTOS">FreeRTOS</a></li>
</ul>
<p>Remote delegates enable function invocation across processes or processors by using customizable serialization and transport mechanisms. All argument data is marshaled to support remote callable endpoints with any function signature. Minimal effort is required to extend support to any new library. Concrete examples are provided using support libraries below.</p>
<ul>
<li><b>Serialization:</b> <a href="https://msgpack.org/index.html">MessagePack</a>, <a href="https://github.com/Tencent/rapidjson">RapidJSON</a>, <a href="https://github.com/endurodave/MessageSerialize">MessageSerialize</a></li>
<li><b>Transport:</b> <a href="https://zeromq.org/">ZeroMQ</a>, UDP, data pipe, memory buffer</li>
</ul>
<p>It is always safe to call the delegate. In its null state, a call will not perform any action and will return a default-constructed return value. A delegate behaves like a normal pointer type: it can be copied, compared for equality, called, and compared to <code>nullptr</code>. Const correctness is maintained; stored const objects can only be called by const member functions.</p>
<p>A delegate instance can be:</p>
<ul>
<li>Copied freely.</li>
<li>Compared to same type delegates and <code>nullptr</code>.</li>
<li>Reassigned.</li>
<li>Called.</li>
</ul>
<p>Typical use cases are:</p>
<ul>
<li>Synchronous and Asynchronous Callbacks</li>
<li>Event-Driven Programming</li>
<li>Inter-Process and Inter-Processor Communication</li>
<li>Inter-Thread Publish/Subscribe (Observer) Pattern</li>
<li>Thread-Safe Asynchronous API</li>
<li>Asynchronous Method Invocation (AMI)</li>
<li>Design Patterns (Active Object)</li>
<li><code>std::async</code> <a class="el" href="class_thread.html">Thread</a> Targeting</li>
</ul>
<p>The DelegateMQ library asynchronous features differ from <code>std::async</code> in that the caller-specified thread of control is used to invoke the target function bound to the delegate, rather than a random thread from the thread pool. The asynchronous variants copy the argument data into an event queue, ensuring safe transport to the destination thread, regardless of the argument type. This approach provides 'fire and forget' functionality, allowing the caller to avoid waiting or worrying about out-of-scope stack variables being accessed by the target thread.</p>
<p>DelegateMQ uses an external thread, transport, and serializer, all of which are based on simple, well-defined interfaces.</p>
<p><img src="docs/LayerDiagram.jpg" alt="DelegateMQ Layer Diagram" style="width:70%;" class="inline"/><br  />
 <em>DelegateMQ Layer Diagram</em></p>
<p>Originally published on CodeProject at <a href="https://www.codeproject.com/Articles/5277036/Asynchronous-Multicast-Delegates-in-Modern-Cpluspl">Asynchronous Multicast Delegates in Modern C++</a> with a perfect 5.0 article feedback rating.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Documentation</h1>
<p>See Design Details for implementation design documentation and more examples.</p>
<p>See <a href="https://endurodave.github.io/DelegateMQ/html/index.html">Doxygen Documentation</a> for source code documentation.</p>
<p>See <a href="https://app.codecov.io/gh/endurodave/DelegateMQ">Unit Test Code Coverage</a> test results.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Project Build</h1>
<p><a href="https://www.cmake.org">CMake</a> is used to create the build files. Visual Studio, GCC, and Clang toolchains are supported. Easy porting to other targets. Execute CMake console commands in the project root directory.</p>
<p><code>cmake -B build -S .</code></p>
<p>See <a href="docs/DETAILS.md#example-projects">Example Projects</a> to build other project examples.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Features</h1>
<p>DelegateMQ at a glance.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Category   </th><th class="markdownTableHeadNone">DelegateMQ    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Purpose   </td><td class="markdownTableBodyNone">DelegateMQ is a library used for invoking any callable synchronously, asynchronously, or remotely    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Usages   </td><td class="markdownTableBodyNone">Callbacks (synchronous and asynchronous), asynchronous API's, communication and data distribution, and more    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Library   </td><td class="markdownTableBodyNone">Allows customizing data sharing between threads, processes, or processors    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Complexity   </td><td class="markdownTableBodyNone">Lightweight and extensible through external library interfaces and full source code    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Threading   </td><td class="markdownTableBodyNone">No internal threads. External configurable thread interface portable to any OS (<code>IThread</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Serialization   </td><td class="markdownTableBodyNone">External configurable serialization data formats, such as MessagePack, RapidJSON, or custom encoding (<code>ISerializer</code>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Transport   </td><td class="markdownTableBodyNone">External configurable transport, such as ZeroMQ, TCP, UDP, serial, data pipe or any custom transport (<code><a class="el" href="class_i_transport.html" title="DelegateMQ transport interface.">ITransport</a></code>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Timeouts and Retries   </td><td class="markdownTableBodyNone">Provided by a communication library (e.g. ZeroMQ REQ-REP (Request-Reply)), TCP/IP stack, or custom solution (<code><a class="el" href="class_i_transport_monitor.html" title="DelegateMQ transport monitor interface.">ITransportMonitor</a></code>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Message Buffering   </td><td class="markdownTableBodyNone">Provided by a communication library (e.g. ZeroMQ) or custom solution within transport    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Dynamic Memory   </td><td class="markdownTableBodyNone">Heap or DelegateMQ fixed-block allocator    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Error Handling   </td><td class="markdownTableBodyNone">Configurable for return error code, assert or exception    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Embedded Friendly   </td><td class="markdownTableBodyNone">Yes. Any OS such as Windows, Linux and FreeRTOS. An OS is not required (i.e. "superloop").    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Operation System   </td><td class="markdownTableBodyNone">Any. Custom <code>IThread</code> implementation may be required.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Language   </td><td class="markdownTableBodyNone">C++17 or higher   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md5"></a>
Related Repositories</h1>
<h2><a class="anchor" id="autotoc_md6"></a>
Alternative Implementations</h2>
<p>Alternative asynchronous implementations similar in concept to DelegateMQ, simpler, and less features.</p>
<ul>
<li><a href="https://github.com/endurodave/AsyncCallback">Asynchronous Callbacks in C++</a> - A C++ asynchronous callback framework.</li>
<li><a href="https://github.com/endurodave/C_AsyncCallback">Asynchronous Callbacks in C</a> - A C language asynchronous callback framework.</li>
</ul>
<h2><a class="anchor" id="autotoc_md7"></a>
Other Projects Using DelegateMQ</h2>
<p>Repositories utilizing the DelegateMQ library.</p>
<ul>
<li><a href="https://github.com/endurodave/AsyncStateMachine">Asynchronous State Machine Design in C++</a> - an asynchronous C++ state machine implemented using an asynchronous delegate library.</li>
<li><a href="https://github.com/endurodave/IntegrationTestFramework">Integration Test Framework using Google Test and Delegates</a> - a multi-threaded C++ software integration test framework using Google Test and Delegate libraries.</li>
<li><a href="https://github.com/endurodave/Async-SQLite">Asynchronous SQLite API using C++ Delegates</a> - an asynchronous SQLite wrapper implemented using an asynchronous delegate library. </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
